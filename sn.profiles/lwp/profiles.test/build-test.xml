<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- ***************************************************************** -->
<!--                                                                   -->
<!-- IBM Confidential                                                  -->
<!--                                                                   -->
<!-- OCO Source Materials                                              -->
<!--                                                                   -->
<!-- Copyright IBM Corp. 2008, 2013                                    -->
<!--                                                                   -->
<!-- The source code for this program is not published or otherwise    -->
<!-- divested of its trade secrets, irrespective of what has been      -->
<!-- deposited with the U.S. Copyright Office.                         -->
<!--                                                                   -->
<!-- ***************************************************************** -->

<!--
 This is an ANT buildfile used to execute the junit and junitreport
 task which is part of the Lotus Connections Unit Test automation.
 Usage: Put build-test.xml and build-test.properties to the root directory
 of the project. Then change to that directory and execute the command:
 ant -f build-test.xml 
-->

<project name="autotest" basedir="." default="report">

  <property file="build-test.properties"/>
  <path id="ut_classpath">
    <pathelement location="${profiles.test.dir}"/>
    <!-- <pathelement location="C:/lwp04.tools/lwp/junit/junit.jar"/> -->

    <pathelement location="${profiles.test.config.dir}" />
    <pathelement location="${profiles.atom.test.dir}" />
    <pathelement location="${profiles.service.test.dir}" />
    <pathelement location="${profiles.search.test.dir}" />
    <pathelement location="${profiles.connections.test.dir}" />

    <fileset dir="${mantis.lib.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.junit.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.abdera.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.abdera.lib.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.xerces.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.jakarta.commons.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.javamail.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.mx4j.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${prereq.log4j.jar.dir}" includes="**/*.jar"/>
    <fileset dir="${profiles.server.lib.dir}" includes="**/*.jar"/>

    <!-- <fileset dir="${prereq.lotus.connections.jar.dir}" includes="**/*.jar"/> -->
    <!-- <fileset dir="C:/temp/conf/LotusConnections-Config" includes="**/*.xml"/> -->
    <!-- <fileset dir="C:/temp/conf/LotusConnections-Config" includes="**/*.xsd"/> -->
    <!-- <fileset dir="${profiles.test.config.dir}" includes="**/*.xml"/> -->
    <!-- <fileset dir="${profiles.test.config.dir}" includes="**/*.xsd"/> -->
    <!-- <fileset dir="${profiles.test.dir}" includes="test.properties"/> -->

    <fileset dir="${was.lib.dir}" includes="**/*.jar"/>
    <fileset dir="${db.config}" includes="**/*.jar"/>
  </path>

  <target name="clean" description="Clean the project">
    <delete dir="${ant.unit.test.report.dir}"/>
  </target>


  <target name="test" depends="clean" description="Execute the unit test">
    <mkdir dir="${ant.unit.test.report.dir}"/>
    <property name="cases" value="*Test"/>

    <junit fork="yes" printsummary="yes" jvm="${java.home}/bin/java">
      <jvmarg value="-Dcatalina.home=${profiles.test.dir}"/>

      <classpath refid="ut_classpath"/>
      <formatter type="plain" usefile="false"/>
      <formatter type="xml"/>

      <test name="com.ibm.connections.profiles.test.config.ConfigTestSuite"  todir="${ant.unit.test.report.dir}"/>
    </junit>
  </target>

  <target name="report" depends="test" description="Create the unit test report">
    <mkdir dir="${ant.unit.test.report.dir}/html"/>
      <junitreport todir="${ant.unit.test.report.dir}">
        <fileset dir="${ant.unit.test.report.dir}">
          <include name="TEST-*.xml"/>
        </fileset>
        <report todir="${ant.unit.test.report.dir}/html"/>
      </junitreport>
  </target>

</project>
