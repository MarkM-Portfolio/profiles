-- ***************************************************************** 
--                                                                   
-- IBM Confidential                                                  
--                                                                   
-- OCO Source Materials                                              
--                                                                   
-- Copyright IBM Corp. 2009, 2012                                    
--                                                                   
-- The source code for this program is not published or otherwise    
-- divested of its trade secrets, irrespective of what has been      
-- deposited with the U.S. Copyright Office.                         
--                                                                   
-- ***************************************************************** 

-- 5724-S68                                                          
USE PEOPLEDB;
GO

------
-- EMPLOYEE: add PROF_STATE columns
------
ALTER TABLE EMPINST.EMPLOYEE ADD PROF_STATE INTEGER NOT NULL DEFAULT 0;
GO

------
--  move state for inactive users from USER_STATE_LAIDX to EMPLOYEE
------
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN (   SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '0' AND S.OBJIDSTR < '147' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '147' AND S.OBJIDSTR < '28f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '28f' AND S.OBJIDSTR < '3d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3d7' AND S.OBJIDSTR < '51e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '51e' AND S.OBJIDSTR < '666' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '666' AND S.OBJIDSTR < '7ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7ae' AND S.OBJIDSTR < '8f5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8f5' AND S.OBJIDSTR < 'a3d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a3d' AND S.OBJIDSTR < 'b85' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b85' AND S.OBJIDSTR < 'ccc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ccc' AND S.OBJIDSTR < 'e14' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e14' AND S.OBJIDSTR < 'f5c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f5c' AND S.OBJIDSTR < '10a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '10a' AND S.OBJIDSTR < '11e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '11e' AND S.OBJIDSTR < '133' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '133' AND S.OBJIDSTR < '147' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '147' AND S.OBJIDSTR < '15c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '15c' AND S.OBJIDSTR < '170' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '170' AND S.OBJIDSTR < '185' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '185' AND S.OBJIDSTR < '199' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '199' AND S.OBJIDSTR < '1ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '1ae' AND S.OBJIDSTR < '1c2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '1c2' AND S.OBJIDSTR < '1d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '1d7' AND S.OBJIDSTR < '1eb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '1eb' AND S.OBJIDSTR < '1ff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '1ff' AND S.OBJIDSTR < '214' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '214' AND S.OBJIDSTR < '228' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '228' AND S.OBJIDSTR < '23d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '23d' AND S.OBJIDSTR < '251' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '251' AND S.OBJIDSTR < '266' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '266' AND S.OBJIDSTR < '27a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '27a' AND S.OBJIDSTR < '28f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '28f' AND S.OBJIDSTR < '2a3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '2a3' AND S.OBJIDSTR < '2b8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '2b8' AND S.OBJIDSTR < '2cc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '2cc' AND S.OBJIDSTR < '2e1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '2e1' AND S.OBJIDSTR < '2f5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '2f5' AND S.OBJIDSTR < '30a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '30a' AND S.OBJIDSTR < '31e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '31e' AND S.OBJIDSTR < '333' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '333' AND S.OBJIDSTR < '347' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '347' AND S.OBJIDSTR < '35c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '35c' AND S.OBJIDSTR < '370' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '370' AND S.OBJIDSTR < '385' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '385' AND S.OBJIDSTR < '399' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '399' AND S.OBJIDSTR < '3ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3ae' AND S.OBJIDSTR < '3c2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3c2' AND S.OBJIDSTR < '3d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3d7' AND S.OBJIDSTR < '3eb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3eb' AND S.OBJIDSTR < '3ff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '3ff' AND S.OBJIDSTR < '414' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '414' AND S.OBJIDSTR < '428' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '428' AND S.OBJIDSTR < '43d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '43d' AND S.OBJIDSTR < '451' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '451' AND S.OBJIDSTR < '466' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '466' AND S.OBJIDSTR < '47a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '47a' AND S.OBJIDSTR < '48f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '48f' AND S.OBJIDSTR < '4a3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '4a3' AND S.OBJIDSTR < '4b8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '4b8' AND S.OBJIDSTR < '4cc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '4cc' AND S.OBJIDSTR < '4e1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '4e1' AND S.OBJIDSTR < '4f5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '4f5' AND S.OBJIDSTR < '50a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '50a' AND S.OBJIDSTR < '51e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '51e' AND S.OBJIDSTR < '533' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '533' AND S.OBJIDSTR < '547' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '547' AND S.OBJIDSTR < '55c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '55c' AND S.OBJIDSTR < '570' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '570' AND S.OBJIDSTR < '585' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '585' AND S.OBJIDSTR < '599' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '599' AND S.OBJIDSTR < '5ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '5ae' AND S.OBJIDSTR < '5c2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '5c2' AND S.OBJIDSTR < '5d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '5d7' AND S.OBJIDSTR < '5eb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '5eb' AND S.OBJIDSTR < '5ff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '5ff' AND S.OBJIDSTR < '614' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '614' AND S.OBJIDSTR < '628' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '628' AND S.OBJIDSTR < '63d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '63d' AND S.OBJIDSTR < '651' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '651' AND S.OBJIDSTR < '666' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '666' AND S.OBJIDSTR < '67a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '67a' AND S.OBJIDSTR < '68f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '68f' AND S.OBJIDSTR < '6a3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '6a3' AND S.OBJIDSTR < '6b8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '6b8' AND S.OBJIDSTR < '6cc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '6cc' AND S.OBJIDSTR < '6e1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '6e1' AND S.OBJIDSTR < '6f5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '6f5' AND S.OBJIDSTR < '70a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '70a' AND S.OBJIDSTR < '71e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '71e' AND S.OBJIDSTR < '733' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '733' AND S.OBJIDSTR < '747' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '747' AND S.OBJIDSTR < '75c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '75c' AND S.OBJIDSTR < '770' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '770' AND S.OBJIDSTR < '785' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '785' AND S.OBJIDSTR < '799' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '799' AND S.OBJIDSTR < '7ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7ae' AND S.OBJIDSTR < '7c2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7c2' AND S.OBJIDSTR < '7d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7d7' AND S.OBJIDSTR < '7eb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7eb' AND S.OBJIDSTR < '7ff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '7ff' AND S.OBJIDSTR < '814' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '814' AND S.OBJIDSTR < '828' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '828' AND S.OBJIDSTR < '83d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '83d' AND S.OBJIDSTR < '851' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '851' AND S.OBJIDSTR < '866' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '866' AND S.OBJIDSTR < '87a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '87a' AND S.OBJIDSTR < '88f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '88f' AND S.OBJIDSTR < '8a3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8a3' AND S.OBJIDSTR < '8b8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8b8' AND S.OBJIDSTR < '8cc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8cc' AND S.OBJIDSTR < '8e1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8e1' AND S.OBJIDSTR < '8f5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '8f5' AND S.OBJIDSTR < '90a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '90a' AND S.OBJIDSTR < '91e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '91e' AND S.OBJIDSTR < '933' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '933' AND S.OBJIDSTR < '947' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '947' AND S.OBJIDSTR < '95c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '95c' AND S.OBJIDSTR < '970' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '970' AND S.OBJIDSTR < '985' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '985' AND S.OBJIDSTR < '999' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '999' AND S.OBJIDSTR < '9ae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '9ae' AND S.OBJIDSTR < '9c2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '9c2' AND S.OBJIDSTR < '9d7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '9d7' AND S.OBJIDSTR < '9eb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '9eb' AND S.OBJIDSTR < '9ff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= '9ff' AND S.OBJIDSTR < 'a14' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a14' AND S.OBJIDSTR < 'a28' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a28' AND S.OBJIDSTR < 'a3d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a3d' AND S.OBJIDSTR < 'a51' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a51' AND S.OBJIDSTR < 'a66' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a66' AND S.OBJIDSTR < 'a7a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a7a' AND S.OBJIDSTR < 'a8f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'a8f' AND S.OBJIDSTR < 'aa3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'aa3' AND S.OBJIDSTR < 'ab8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ab8' AND S.OBJIDSTR < 'acc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'acc' AND S.OBJIDSTR < 'ae1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ae1' AND S.OBJIDSTR < 'af5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'af5' AND S.OBJIDSTR < 'b0a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b0a' AND S.OBJIDSTR < 'b1e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b1e' AND S.OBJIDSTR < 'b33' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b33' AND S.OBJIDSTR < 'b47' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b47' AND S.OBJIDSTR < 'b5c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b5c' AND S.OBJIDSTR < 'b70' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b70' AND S.OBJIDSTR < 'b85' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b85' AND S.OBJIDSTR < 'b99' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'b99' AND S.OBJIDSTR < 'bae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'bae' AND S.OBJIDSTR < 'bc2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'bc2' AND S.OBJIDSTR < 'bd7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'bd7' AND S.OBJIDSTR < 'beb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'beb' AND S.OBJIDSTR < 'bff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'bff' AND S.OBJIDSTR < 'c14' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c14' AND S.OBJIDSTR < 'c28' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c28' AND S.OBJIDSTR < 'c3d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c3d' AND S.OBJIDSTR < 'c51' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c51' AND S.OBJIDSTR < 'c66' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c66' AND S.OBJIDSTR < 'c7a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c7a' AND S.OBJIDSTR < 'c8f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'c8f' AND S.OBJIDSTR < 'ca3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ca3' AND S.OBJIDSTR < 'cb8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'cb8' AND S.OBJIDSTR < 'ccc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ccc' AND S.OBJIDSTR < 'ce1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ce1' AND S.OBJIDSTR < 'cf5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'cf5' AND S.OBJIDSTR < 'd0a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd0a' AND S.OBJIDSTR < 'd1e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd1e' AND S.OBJIDSTR < 'd33' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd33' AND S.OBJIDSTR < 'd47' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd47' AND S.OBJIDSTR < 'd5c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd5c' AND S.OBJIDSTR < 'd70' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd70' AND S.OBJIDSTR < 'd85' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd85' AND S.OBJIDSTR < 'd99' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'd99' AND S.OBJIDSTR < 'dae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'dae' AND S.OBJIDSTR < 'dc2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'dc2' AND S.OBJIDSTR < 'dd7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'dd7' AND S.OBJIDSTR < 'deb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'deb' AND S.OBJIDSTR < 'dff' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'dff' AND S.OBJIDSTR < 'e14' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e14' AND S.OBJIDSTR < 'e28' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e28' AND S.OBJIDSTR < 'e3d' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e3d' AND S.OBJIDSTR < 'e51' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e51' AND S.OBJIDSTR < 'e66' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e66' AND S.OBJIDSTR < 'e7a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e7a' AND S.OBJIDSTR < 'e8f' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'e8f' AND S.OBJIDSTR < 'ea3' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ea3' AND S.OBJIDSTR < 'eb8' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'eb8' AND S.OBJIDSTR < 'ecc' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ecc' AND S.OBJIDSTR < 'ee1' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ee1' AND S.OBJIDSTR < 'ef5' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'ef5' AND S.OBJIDSTR < 'f0a' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f0a' AND S.OBJIDSTR < 'f1e' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f1e' AND S.OBJIDSTR < 'f33' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f33' AND S.OBJIDSTR < 'f47' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f47' AND S.OBJIDSTR < 'f5c' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f5c' AND S.OBJIDSTR < 'f70' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f70' AND S.OBJIDSTR < 'f85' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f85' AND S.OBJIDSTR < 'f99' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'f99' AND S.OBJIDSTR < 'fae' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'fae' AND S.OBJIDSTR < 'fc2' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'fc2' AND S.OBJIDSTR < 'fd7' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'fd7' AND S.OBJIDSTR < 'feb' );
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.OBJIDSTR FROM EMPINST.USER_STATE_LAIDX S WHERE S.USRSTATE = 1 AND S.OBJIDSTR >= 'feb' );
GO

------
-- drop FK and other constratins for LAIDX tables
-------
ALTER TABLE EMPINST.USER_STATE_LAIDX DROP CONSTRAINT USRSTATE_ATTR_FK;
GO

ALTER TABLE EMPINST.USER_STATE_LAIDX DROP CONSTRAINT USRSTATE_DEF_FK;
GO

ALTER TABLE EMPINST.USER_ORGS_LAIDX DROP CONSTRAINT USRORGS_ATTR_FK;
GO

ALTER TABLE EMPINST.USER_ORGS_LAIDX DROP CONSTRAINT USRORGS_DEF_FK;
GO

------
-- LAIDX may be incomplete, also pick up state from SURNAME table
------
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '0' AND S.PROF_KEY < '199');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '199' AND S.PROF_KEY < '333');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '333' AND S.PROF_KEY < '4cc');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '4cc' AND S.PROF_KEY < '666');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '666' AND S.PROF_KEY < '7ff');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '7ff' AND S.PROF_KEY < '999');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= '999' AND S.PROF_KEY < 'b33');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= 'b33' AND S.PROF_KEY < 'ccc');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= 'ccc' AND S.PROF_KEY < 'e66');
GO   
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 0 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 0 AND E.PROF_STATE = 1 AND S.PROF_KEY >= 'e66');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '0' AND S.PROF_KEY < '199');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '199' AND S.PROF_KEY < '333');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '333' AND S.PROF_KEY < '4cc');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '4cc' AND S.PROF_KEY < '666');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '666' AND S.PROF_KEY < '7ff');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '7ff' AND S.PROF_KEY < '999');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= '999' AND S.PROF_KEY < 'b33');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= 'b33' AND S.PROF_KEY < 'ccc');
GO
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= 'ccc' AND S.PROF_KEY < 'e66');
GO   
UPDATE EMPINST.EMPLOYEE SET PROF_STATE = 1 WHERE PROF_KEY IN ( SELECT S.PROF_KEY FROM EMPINST.SURNAME S, EMPINST.EMPLOYEE E WHERE E.PROF_KEY = S.PROF_KEY AND S.PROF_USRSTATE = 1 AND E.PROF_STATE = 0 AND S.PROF_KEY >= 'e66');
GO


------
-- drop 'index' tables
------
DROP TABLE EMPINST.USER_STATE_LAIDX;
GO

DROP TABLE EMPINST.USER_ORGS_LAIDX;
GO

------
-- remove dynamic attributes
------
DELETE FROM EMPINST.DYNA_DEFS WHERE OBJFACET = 'sys.usrState.idx';
GO
DELETE FROM EMPINST.DYNA_DEFS WHERE OBJFACET = 'sys.usrOrgMem.idx';
GO
DELETE FROM EMPINST.DYNA_DEFS WHERE OBJFACET = 'sys.usrOrgAcl.idx';
GO

------
-- Update schema version
------

UPDATE EMPINST.SNPROF_SCHEMA SET DBSCHEMAVER= 32, RELEASEVER='4.0.0.0' WHERE COMPKEY='Profiles';
GO
